{% load static %}
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Mew{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'chat/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'vendor/fontawesome/css/all.min.css' %}">
    {% block extra_head %}{% endblock %}
    <style>
        body {
                {% block body_bg %}

            background-color: #f5f7fb;

                {% endblock %}

            font-family: 'Helvetica Neue',
            'PingFang SC',
            'Microsoft YaHei',
            sans-serif;
        }

        .container {
            max-width: 400px;
            margin-top: 80px;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        .form-control {
            border-radius: 6px;
        }

        h3 {
            font-weight: bold;
            color: #333;
        }

        a {
            color: #007bff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .navbar {
            border-radius: 0;
            margin: 0 0 24px 0;
            box-shadow: 0 4px 24px rgba(168, 106, 227, 0.10), 0 1.5px 8px rgba(252, 176, 196, 0.10);
            background: linear-gradient(90deg, #a86ae3 0%, #fcb0c4 100%) !important;
            padding: 1.2rem 3.2rem;
            max-width: 100%;
            width: 100%;
            font-size: 1.25rem;
        }

        .navbar .navbar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 2.6rem;
            font-weight: bold;
            color: #fff !important;
            letter-spacing: 2px;
            font-family: 'ZCOOL KuaiLe', 'FZLanTingHeiS-R-GB', 'STXingkai', 'Arial', cursive, sans-serif;
        }

        .navbar .logo-icon {
            font-size: 2.8rem;
            margin-right: 2px;
        }

        .navbar-nav {
            display: flex;
            align-items: center;
            gap: 28px;
            list-style: none;
            margin-bottom: 0;
            padding-left: 0;
        }

        .nav-card {
            background: rgba(255, 255, 255, 0.22);
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(168, 106, 227, 0.08);
            border: 1.5px solid rgba(168, 106, 227, 0.18);
            padding: 6px 22px;
            transition: background 0.2s, box-shadow 0.2s, border 0.2s;
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .nav-card .nav-link {
            color: #fff !important;
            font-weight: 500;
            font-size: 1.13rem;
            background: none;
            border: none;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
            text-decoration: none !important;
            display: block;
            width: 100%;
            height: 100%;
        }

        .nav-card:hover,
        .nav-card:focus-within {
            background: rgba(255, 255, 255, 0.38);
            border: 1.5px solid #a86ae3;
            box-shadow: 0 4px 16px rgba(168, 106, 227, 0.13);
        }

        .navbar-nav .nav-link:hover,
        .navbar-nav .btn:hover {
            color: #a86ae3 !important;
            background: none;
        }

        .navbar .btn-outline-danger,
        .navbar .btn-outline-light,
        .navbar .btn-light {
            border: 2px solid #fff;
            color: #fff !important;
            background: transparent;
            border-radius: 22px;
            font-weight: 500;
            margin-left: 12px;
            font-size: 1.1rem;
            padding: 10px 28px;
            text-decoration: none !important;
        }

        .navbar .btn-outline-danger:hover,
        .navbar .btn-outline-light:hover,
        .navbar .btn-light:hover {
            background: #fff;
            color: #a86ae3 !important;
        }

        .navbar-toggler {
            display: none;
        }

        .navbar-content {
            display: flex;
            width: 100%;
            align-items: center;
            justify-content: space-between;
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 28px;
            flex-shrink: 0;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 2.6rem;
            font-weight: bold;
            color: #fff !important;
            letter-spacing: 2px;
            font-family: 'ZCOOL KuaiLe', 'FZLanTingHeiS-R-GB', 'STXingkai', 'Arial', cursive, sans-serif;
            margin-right: 18px;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 18px;
            flex-shrink: 0;
        }

        @media (max-width: 600px) {
            .navbar {
                padding: 0.5rem 0.7rem;
                max-width: 100%;
                font-size: 1rem;
            }

            .container {
                padding: 16px;
                margin-top: 24px;
            }

            .navbar-nav {
                gap: 8px;
            }

            .navbar .navbar-brand {
                font-size: 1.2rem;
            }

            .nav-card {
                padding: 4px 10px;
            }
        }
    </style>
    <script src="{% static 'chat/js/jquery.min.js' %}"></script>
    <script src="{% static 'chat/js/bootstrap.bundle.min.js' %}"></script>
    <meta name="csrf-token" content="{{ csrf_token }}">
</head>

<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid" style="max-width: 1100px;">
            <div class="navbar-content">
                <div class="navbar-left">
                    <a class="navbar-brand" href="{% url 'plaza:list' %}"
                        style="display:flex;align-items:center;justify-content:flex-start;margin-right:32px;">
                        <span
                            style="font-weight:900;font-size:4rem;color:#fff;text-shadow:0 1px 8px rgba(80,0,120,0.13);letter-spacing:2.5px;">
                            Mew
                        </span>
                    </a>
                    <ul class="navbar-nav">
                        <li class="nav-item nav-card" data-url="/chat/">
                            <a class="nav-link" href="/chat/">聊天室</a>
                        </li>
                        <li class="nav-item nav-card" data-url="{% url 'moments:list' %}">
                            <a class="nav-link" href="{% url 'moments:list' %}">朋友圈</a>
                        </li>
                        <li class="nav-item nav-card" data-url="{% url 'plaza:list' %}">
                            <a class="nav-link" href="{% url 'plaza:list' %}">广场</a>
                        </li>
                        <li class="nav-item nav-card" data-url="{% url 'blog_list' %}">
                            <a class="nav-link" href="{% url 'blog_list' %}">我的博客</a>
                        </li>
                    </ul>
                </div>
                <div class="navbar-right">
                    <ul class="navbar-nav">
                        {% if user.is_authenticated %}
                        <li class="nav-item">
                            <span class="nav-link"><b>{{ user.user_profile.nickname|default:user.username }}</b></span>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'userzone:detail' username=user.username %}" title="个人空间"
                                style="display:inline-flex;position:relative;width:40px;height:40px;min-width:40px;min-height:40px;border-radius:50%;background:#efefef;align-items:center;justify-content:center;margin-left:2px;vertical-align:middle;overflow:hidden;box-shadow:0 0 0 3px #e5d6fa,0 0 12px 0 #e5d6fa;cursor:pointer;text-decoration:none!important;">
                                {% if user.user_profile.avatar %}
                                {% if user.user_profile.avatar.url != '/media/avatars/default.jpg' %}
                                <img src="{{ user.user_profile.avatar.url }}"
                                    style="position:absolute;left:0;top:0;width:100%;height:100%;object-fit:cover;border-radius:50%;">
                                {% else %}
                                <span style="font-size:1.25rem;color:#a86ae3;font-weight:600;">
                                    {{ user.username|first|upper }}
                                </span>
                                {% endif %}
                                {% else %}
                                <span style="font-size:1.25rem;color:#a86ae3;font-weight:600;">
                                    {{ user.username|first|upper }}
                                </span>
                                {% endif %}
                            </a>
                        </li>
                        <li class="nav-item">
                            <form method="post" action="{% url 'logout' %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-outline-danger btn-sm"
                                    style="margin-top:4px;cursor:pointer;">退出</button>
                            </form>
                        </li>
                        {% endif %}
                        {% if not user.is_authenticated %}
                        <li class="nav-item">
                            <a class="btn btn-outline-light btn-sm me-2" href="{% url 'login' %}">登录</a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-light btn-sm" href="{% url 'register' %}">注册</a>
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    {% block content %}{% endblock %}

    <script>
        // 导航按钮点击事件处理
        document.addEventListener('DOMContentLoaded', function () {
            const navCards = document.querySelectorAll('.nav-card');
            navCards.forEach(function (card) {
                card.addEventListener('click', function (e) {
                    // 如果点击的是链接本身，不阻止默认行为
                    if (e.target.classList.contains('nav-link')) {
                        return;
                    }
                    // 否则阻止默认行为，使用data-url进行跳转
                    e.preventDefault();
                    const url = this.getAttribute('data-url');
                    if (url) {
                        window.location.href = url;
                    }
                });
            });
        });
    </script>
</body>

</html>