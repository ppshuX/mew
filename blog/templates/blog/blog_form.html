{% extends "base.html" %}
{% load static %}

{% block title %}写动态{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'blog/css/blog_form.css' %}">
<div class="mew-form-bg">
    <div class="mew-form-card">
        <div class="mew-form-title">
            <span style="font-size: 2.2rem; vertical-align: middle;">📝</span>
            <span style="vertical-align: middle;">写动态</span>
        </div>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="mb-4">
                <label class="mew-form-label">标题（可选）</label>
                {{ form.title }}
                <div class="mew-form-text">标题是可选的，如果不填写将只显示内容</div>
            </div>
            <div class="mb-4">
                <label class="mew-form-label">内容 <span style="color: #ff6bcb;">*</span></label>
                {{ form.content }}
                <div id="content-counter" style="text-align:right;font-size:0.98rem;margin-top:4px;color:#aaa;">
                </div>
                <div id="content-warning" style="color:#ff4d4f;font-size:0.98rem;margin-top:2px;display:none;">
                    字数已超出最大限制！
                </div>
            </div>
            <div class="mb-4">
                <label class="mew-form-label">类别</label>
                {{ form.category }}
            </div>
            <div class="mb-4">
                <label class="mew-form-label">配图</label>
                {{ form.cover_image }}
                <div class="mew-form-text">可以选择一张图片作为动态配图</div>
                <!-- 多图上传区域 -->
                <div style="margin-top:10px;">
                    <label class="mew-form-label">多图上传</label>
                    <div id="image-preview-container" style="display:flex;flex-wrap:wrap;gap:10px;"></div>
                    <input type="file" id="id_images" name="images" accept="image/*" multiple style="display:none;">
                    <button type="button" id="add-image-btn" class="btn btn-outline-primary"
                        style="margin-top:8px;">选择图片</button>
                    <div class="mew-form-text">最多可选9张图片，支持预览和删除</div>
                </div>
            </div>
            <div class="mb-4">
                <label class="mew-form-label">发布到</label>
                {{ form.publish_type }}
            </div>
            <hr class="mew-form-btn-divider">
            <div class="mew-form-btn-row">
                <a href="{% url 'userzone:detail' request.user.username %}" class="mew-form-btn-cancel">取消</a>
                <button type="submit" class="mew-form-btn-main">发布</button>
            </div>
        </form>
    </div>
</div>
<script src="{% static 'blog/js/blog_form.js' %}"></script>
{% endblock %}