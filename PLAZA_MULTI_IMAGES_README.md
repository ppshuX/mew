# Plaza 多图片功能实现

## 功能概述

Plaza页面现在支持多张图片的上传和显示，实现了类似Moments的响应式图片网格布局。

## 主要改进

### 1. 数据模型更新
- 新增 `PostImage` 模型，支持一个帖子关联多张图片
- 保留原有的 `image` 字段以兼容旧数据
- 图片按上传时间排序

### 2. 响应式图片网格布局
- **单张图片**: 居中显示，最大宽度400px
- **两张图片**: 并排显示，各占50%宽度
- **三张图片**: 前两张并排，第三张居中显示
- **四张及以上**: 自适应网格布局，根据屏幕宽度调整列数

### 3. 响应式设计
- **桌面端**: 图片网格最小宽度160px
- **平板端**: 图片网格最小宽度140px  
- **手机端**: 图片网格最小宽度100px-120px

### 4. 交互效果
- 图片悬停时有轻微放大效果
- 图片点击可跳转到详情页
- 详情页支持图片网格浏览

## 技术实现

### CSS Grid 布局
使用现代CSS Grid技术实现响应式布局：

```css
/* 四张及以上图片的网格布局 */
.image-grid:has(.image-card:nth-child(n+4)) {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
}
```

### 模板更新
- 支持新旧两种图片数据格式
- 自动检测图片数量并应用相应布局
- 详情页同样支持多图片显示

### 后端处理
- 支持多文件上传 (`request.FILES.getlist('image')`)
- 自动创建 `PostImage` 记录
- 保持向后兼容性

## 使用方法

1. 在发布动态时，可以选择多张图片
2. 图片会自动按响应式网格布局显示
3. 点击图片可查看详情页
4. 详情页支持完整的图片网格浏览

## 兼容性

- 完全兼容现有的单图片帖子
- 自动检测并显示旧格式的图片
- 新发布的帖子支持多图片功能

## 文件修改清单

- `plaza/models.py` - 新增PostImage模型
- `plaza/views.py` - 支持多图片上传
- `plaza/templates/plaza/plaza.html` - 多图片显示模板
- `plaza/templates/plaza/detail.html` - 详情页多图片显示
- `plaza/static/plaza/css/plaza.css` - 响应式图片网格样式 